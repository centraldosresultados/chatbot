# ğŸ“ Diagramas de Arquitetura - MigraÃ§Ã£o ChatBot

Este documento contÃ©m diagramas visuais em texto ASCII para facilitar o entendimento da arquitetura atual vs nova.

---

## ğŸ›ï¸ Arquitetura Atual (Socket.io + whatsapp-web.js)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ARQUITETURA ATUAL                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                                  â”‚                 â”‚
â”‚    FRONTEND     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ WebSocket â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚     BACKEND     â”‚
â”‚  (React CRA)    â”‚          (Socket.io)            â”‚  (Socket.io +   â”‚
â”‚                 â”‚                                  â”‚  whatsapp-web)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                                     â”‚
        â”‚                                                     â”‚
        â”‚                                                     â”‚
        â”‚                                                     â–¼
        â”‚                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                            â”‚                 â”‚
        â”‚                                            â”‚   Puppeteer     â”‚
        â”‚                                            â”‚   (Headless     â”‚
        â”‚                                            â”‚    Chrome)      â”‚
        â”‚                                            â”‚                 â”‚
        â”‚                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                                     â”‚
        â”‚                                                     â”‚
        â”‚                                                     â–¼
        â”‚                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                            â”‚                 â”‚
        â”‚                                            â”‚    WhatsApp     â”‚
        â”‚                                            â”‚      Web        â”‚
        â”‚                                            â”‚                 â”‚
        â”‚                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚
â”‚    MongoDB      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
                                                      â”‚
                                             (Driver nativo)


CARACTERÃSTICAS ATUAIS:

âœ“ ComunicaÃ§Ã£o em tempo real via WebSocket
âœ“ DependÃªncia de browser headless (pesado)
âœ“ Mais complexo de escalar
âœ— Consome muita memÃ³ria (~300-500MB base + Puppeteer)
âœ— Build lento do frontend (CRA)
âœ— Dificulta cache HTTP
```

---

## ğŸš€ Arquitetura Nova (Express REST + Baileys)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ARQUITETURA NOVA                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                                  â”‚                 â”‚
â”‚    FRONTEND     â”‚â—„â”€â”€â”€â”€â”€â”€ HTTP REST API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚     BACKEND     â”‚
â”‚   (React +      â”‚        (Fetch/Axios)            â”‚   (Express +    â”‚
â”‚    Vite)        â”‚                                  â”‚    Baileys)     â”‚
â”‚                 â”‚                                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                                     â”‚
        â”‚         (Opcional: WebSocket sÃ³ para chat)         â”‚
        â”‚â—„â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â–ºâ”‚
        â”‚                                                     â”‚
        â”‚                                                     â”‚
        â”‚                                                     â–¼
        â”‚                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                            â”‚                 â”‚
        â”‚                                            â”‚    Baileys      â”‚
        â”‚                                            â”‚  (Lib nativa)   â”‚
        â”‚                                            â”‚   Sem browser!  â”‚
        â”‚                                            â”‚                 â”‚
        â”‚                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                                     â”‚
        â”‚                                                     â”‚
        â”‚                                                     â–¼
        â”‚                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                            â”‚                 â”‚
        â”‚                                            â”‚    WhatsApp     â”‚
        â”‚                                            â”‚     Protocol    â”‚
        â”‚                                            â”‚                 â”‚
        â”‚                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚
â”‚    MongoDB      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
                                                (Mongoose ODM)


CARACTERÃSTICAS NOVAS:

âœ“ APIs REST stateless (fÃ¡cil cache)
âœ“ Sem dependÃªncia de browser
âœ“ Muito mais leve (~100-150MB)
âœ“ Build ultra-rÃ¡pido (Vite)
âœ“ FÃ¡cil de escalar horizontalmente
âœ“ Melhor para microserviÃ§os
```

---

## ğŸ“Š Fluxo de Dados - Envio de ValidaÃ§Ã£o

### ATUAL (Socket.io)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend â”‚                                                    â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚  1. socket.emit('enviarValidacao', dados, callback)         â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
      â”‚                                                              â”‚
      â”‚                                                              â”‚  2. Processa
      â”‚                                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                                              â”‚         â”‚
      â”‚                                                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚                                                              â”‚  3. Envia WA
      â”‚                                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                                              â”‚         â”‚
      â”‚                                                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚                                                              â”‚  4. Salva DB
      â”‚                                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                                              â”‚         â”‚
      â”‚                                                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚  5. callback({ sucesso: true, id: "..." })                  â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â”‚                                                              â”‚
      â”‚  6. socket.on('statusMensagem', data)                       â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â”‚                                                              â”‚
```

### NOVO (REST API)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend â”‚                                                    â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚  1. POST /api/validations/send-validation                   â”‚
      â”‚     { telefone, nome_completo }                             â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
      â”‚                                                              â”‚
      â”‚                                                              â”‚  2. Valida
      â”‚                                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                                              â”‚         â”‚
      â”‚                                                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚                                                              â”‚  3. Envia WA
      â”‚                                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                                              â”‚         â”‚
      â”‚                                                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚                                                              â”‚  4. Salva DB
      â”‚                                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                                              â”‚         â”‚
      â”‚                                                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                              â”‚
      â”‚  5. Response: 200 OK                                        â”‚
      â”‚     { success: true, id: "...", dbId: "..." }               â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â”‚                                                              â”‚
      â”‚  6. (Opcional) Polling para atualizar status               â”‚
      â”‚  GET /api/validations/status/:id                            â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
      â”‚                                                              â”‚
      â”‚  7. Response: { status: "Entregue" }                        â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â”‚                                                              â”‚
```

---

## ğŸ—‚ï¸ Estrutura de DiretÃ³rios Detalhada

### Backend Novo

```
back-novo/
â”‚
â”œâ”€â”€ server.js                    # Servidor principal
â”‚   â”œâ”€â”€ ConfiguraÃ§Ã£o Express
â”‚   â”œâ”€â”€ Middleware (CORS, JSON)
â”‚   â”œâ”€â”€ InicializaÃ§Ã£o Baileys
â”‚   â””â”€â”€ Rotas principais
â”‚
â”œâ”€â”€ config.js                    # ConfiguraÃ§Ãµes centralizadas
â”‚   â”œâ”€â”€ Porta do servidor
â”‚   â”œâ”€â”€ URI do MongoDB
â”‚   â”œâ”€â”€ ConfiguraÃ§Ãµes WhatsApp
â”‚   â””â”€â”€ ConfiguraÃ§Ãµes CORS
â”‚
â”œâ”€â”€ package.json                 # DependÃªncias
â”‚   â”œâ”€â”€ @whiskeysockets/baileys
â”‚   â”œâ”€â”€ express
â”‚   â”œâ”€â”€ mongoose
â”‚   â”œâ”€â”€ cors
â”‚   â””â”€â”€ qrcode
â”‚
â”œâ”€â”€ models/                      # Schemas Mongoose
â”‚   â”œâ”€â”€ Validacao.js
â”‚   â”‚   â”œâ”€â”€ telefone
â”‚   â”‚   â”œâ”€â”€ nome_completo
â”‚   â”‚   â”œâ”€â”€ status_mensagem
â”‚   â”‚   â”œâ”€â”€ id_mensagem
â”‚   â”‚   â””â”€â”€ historicoReenvios[]
â”‚   â”‚
â”‚   â”œâ”€â”€ EnvioSenha.js
â”‚   â”‚   â”œâ”€â”€ telefone
â”‚   â”‚   â”œâ”€â”€ nome_completo
â”‚   â”‚   â”œâ”€â”€ senha_provisoria
â”‚   â”‚   â””â”€â”€ status_mensagem
â”‚   â”‚
â”‚   â””â”€â”€ Mensagem.js
â”‚       â”œâ”€â”€ id_lote
â”‚       â”œâ”€â”€ mensagem
â”‚       â”œâ”€â”€ criadores[]
â”‚       â””â”€â”€ estatÃ­sticas
â”‚
â”œâ”€â”€ routes/                      # Rotas da API
â”‚   â”œâ”€â”€ whatsapp.js
â”‚   â”‚   â”œâ”€â”€ POST /api/connect
â”‚   â”‚   â”œâ”€â”€ GET  /api/qrcode
â”‚   â”‚   â”œâ”€â”€ GET  /api/status
â”‚   â”‚   â””â”€â”€ POST /api/disconnect
â”‚   â”‚
â”‚   â”œâ”€â”€ validacoes.js
â”‚   â”‚   â”œâ”€â”€ POST /api/validations/send-validation
â”‚   â”‚   â””â”€â”€ GET  /api/validations/list
â”‚   â”‚
â”‚   â”œâ”€â”€ senhas.js
â”‚   â”‚   â”œâ”€â”€ POST /api/passwords/send-password
â”‚   â”‚   â””â”€â”€ GET  /api/passwords/list
â”‚   â”‚
â”‚   â””â”€â”€ mensagens.js
â”‚       â”œâ”€â”€ POST /api/messages/send-to-all
â”‚       â””â”€â”€ GET  /api/messages/list
â”‚
â”œâ”€â”€ controllers/                 # LÃ³gica de negÃ³cio
â”‚   â”œâ”€â”€ whatsappController.js
â”‚   â”‚   â”œâ”€â”€ initializeWhatsApp()
â”‚   â”‚   â”œâ”€â”€ handleConnection()
â”‚   â”‚   â””â”€â”€ handleDisconnection()
â”‚   â”‚
â”‚   â””â”€â”€ mensagensController.js
â”‚       â”œâ”€â”€ sendMessage()
â”‚       â”œâ”€â”€ processResponse()
â”‚       â””â”€â”€ updateStatus()
â”‚
â”œâ”€â”€ utils/                       # FunÃ§Ãµes auxiliares
â”‚   â”œâ”€â”€ validacoes.js
â”‚   â”‚   â”œâ”€â”€ validarNumero()
â”‚   â”‚   â””â”€â”€ gerarVariacoes()
â”‚   â”‚
â”‚   â””â”€â”€ formatadores.js
â”‚       â”œâ”€â”€ formatarTelefone()
â”‚       â””â”€â”€ formatarMensagem()
â”‚
â””â”€â”€ auth_info_baileys/          # Credenciais WhatsApp (auto-gerado)
    â”œâ”€â”€ creds.json
    â””â”€â”€ app-state-sync-*.json
```

### Frontend Novo

```
front-novo/
â”‚
â”œâ”€â”€ index.html                   # HTML principal
â”‚   â””â”€â”€ <div id="root"></div>
â”‚
â”œâ”€â”€ vite.config.js              # ConfiguraÃ§Ã£o Vite
â”‚   â”œâ”€â”€ Plugins
â”‚   â”œâ”€â”€ Proxy para API
â”‚   â””â”€â”€ Build settings
â”‚
â”œâ”€â”€ package.json                # DependÃªncias
â”‚   â”œâ”€â”€ react
â”‚   â”œâ”€â”€ react-dom
â”‚   â””â”€â”€ vite
â”‚
â””â”€â”€ src/
    â”‚
    â”œâ”€â”€ main.jsx                # Entrada da aplicaÃ§Ã£o
    â”‚   â”œâ”€â”€ import React
    â”‚   â”œâ”€â”€ import ReactDOM
    â”‚   â””â”€â”€ render App
    â”‚
    â”œâ”€â”€ App.jsx                 # Componente principal
    â”‚   â”œâ”€â”€ Estado global
    â”‚   â”œâ”€â”€ Roteamento
    â”‚   â””â”€â”€ Layout
    â”‚
    â”œâ”€â”€ config.js               # ConfiguraÃ§Ãµes
    â”‚   â””â”€â”€ API_BASE_URL
    â”‚
    â”œâ”€â”€ components/             # Componentes React
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Conexao/
    â”‚   â”‚   â”œâ”€â”€ ConexaoWhatsApp.jsx
    â”‚   â”‚   â”œâ”€â”€ QRCodeDisplay.jsx
    â”‚   â”‚   â””â”€â”€ StatusIndicator.jsx
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Validacao/
    â”‚   â”‚   â”œâ”€â”€ EnviarValidacao.jsx
    â”‚   â”‚   â””â”€â”€ ListaValidacoes.jsx
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Senhas/
    â”‚   â”‚   â”œâ”€â”€ EnviarSenha.jsx
    â”‚   â”‚   â””â”€â”€ ListaSenhas.jsx
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Mensagens/
    â”‚   â”‚   â”œâ”€â”€ EnviarMensagem.jsx
    â”‚   â”‚   â”œâ”€â”€ SelecionarCriadores.jsx
    â”‚   â”‚   â””â”€â”€ ListaMensagens.jsx
    â”‚   â”‚
    â”‚   â”œâ”€â”€ Chat/
    â”‚   â”‚   â”œâ”€â”€ ChatWhatsApp.jsx
    â”‚   â”‚   â”œâ”€â”€ Conversas.jsx
    â”‚   â”‚   â””â”€â”€ MensagensConversa.jsx
    â”‚   â”‚
    â”‚   â””â”€â”€ Historico/
    â”‚       â”œâ”€â”€ HistoricoValidacoes.jsx
    â”‚       â”œâ”€â”€ HistoricoSenhas.jsx
    â”‚       â””â”€â”€ HistoricoMensagens.jsx
    â”‚
    â”œâ”€â”€ services/               # ServiÃ§os de API
    â”‚   â”‚
    â”‚   â””â”€â”€ api.js
    â”‚       â”œâ”€â”€ class ApiService
    â”‚       â”œâ”€â”€ connect()
    â”‚       â”œâ”€â”€ sendMessage()
    â”‚       â”œâ”€â”€ sendValidation()
    â”‚       â””â”€â”€ getHistory()
    â”‚
    â””â”€â”€ styles/                 # Estilos
        â””â”€â”€ App.css
```

---

## ğŸ”„ Ciclo de Vida de uma Mensagem

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CICLO DE VIDA DE MENSAGEM                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. CRIAÃ‡ÃƒO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Frontend   â”‚ UsuÃ¡rio preenche formulÃ¡rio
   â”‚   Form      â”‚ (telefone, nome, mensagem)
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
2. ENVIO PARA BACKEND
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/  â”‚ { telefone, mensagem }
   â”‚ send-messageâ”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
3. VALIDAÃ‡ÃƒO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Validar     â”‚ â†’ NÃºmero tem 10 ou 11 dÃ­gitos?
   â”‚  NÃºmero     â”‚ â†’ DDD vÃ¡lido?
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â†’ Formatar corretamente
          â”‚
          â–¼
4. TENTATIVA DE ENVIO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Baileys   â”‚ â†’ VariaÃ§Ã£o 1: DDDNNNNNNNNN (11 dÃ­gitos)
   â”‚ sendMessage â”‚ â†’ VariaÃ§Ã£o 2: DDDNNNNNNNN (10 dÃ­gitos)
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â†’ AtÃ© 3 tentativas cada
          â”‚
          â”œâ”€â–º SUCESSO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                         â”‚
          â””â”€â–º ERRO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                                â”‚   â”‚
                                â–¼   â–¼
5. REGISTRO NO BANCO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  MongoDB                        â”‚
   â”‚  â”œâ”€â”€ id_mensagem: "xyz123"      â”‚
   â”‚  â”œâ”€â”€ telefone: "11999999999"    â”‚
   â”‚  â”œâ”€â”€ status: "Enviada"          â”‚
   â”‚  â””â”€â”€ dataEnvio: Date.now()      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
6. MONITORAMENTO (5 minutos)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Timer     â”‚ Verificar status apÃ³s 5 min
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â–º Status: Entregue â†’ âœ“ OK
          â”‚
          â””â”€â–º Status: NÃ£o Entregue
                    â”‚
                    â–¼
7. REENVIO AUTOMÃTICO (se aplicÃ¡vel)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Reenvio   â”‚ Tentar formato alternativo
   â”‚ Alternativo â”‚ 11 â†’ 10 ou 10 â†’ 11 dÃ­gitos
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
8. NOTIFICAÃ‡ÃƒO ADMIN
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  WhatsApp   â”‚ "Mensagem nÃ£o entregue para..."
   â”‚    Admin    â”‚ Detalhes do problema
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Fluxo de ConexÃ£o WhatsApp

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FLUXO DE CONEXÃƒO WHATSAPP                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CASO 1: PRIMEIRA CONEXÃƒO (Sem credenciais)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ UsuÃ¡rio  â”‚
    â”‚  clica   â”‚
    â”‚"Conectar"â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚POST /api/   â”‚
    â”‚  connect    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ initializeWhatsApp()â”‚
    â”‚ - Baileys gera QR   â”‚
    â”‚ - Status: connectingâ”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚GET /api/    â”‚
    â”‚  qrcode     â”‚ â—„â”€â”€â”€ Polling a cada 2s
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Exibe QR   â”‚
    â”‚  no Front   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   UsuÃ¡rio   â”‚
    â”‚  escaneia   â”‚
    â”‚  no celular â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ connection.update   â”‚
    â”‚ status: 'open'      â”‚
    â”‚ - Salvar creds      â”‚
    â”‚ - Status: connected â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


CASO 2: RECONEXÃƒO AUTOMÃTICA (Com credenciais)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Servidor     â”‚
    â”‚  inicia      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚hasStoredCredentialsâ”‚
    â”‚     == true?        â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Sim
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ autoReconnect()     â”‚
    â”‚ Tenta 5x com delay  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â–º Sucesso â”€â”€â–º Status: connected âœ“
           â”‚
           â””â”€â–º Falha â”€â”€â”€â”€â”€â–º Aguarda nova conexÃ£o manual


CASO 3: PERDA DE CONEXÃƒO (Durante uso)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ WhatsApp     â”‚
    â”‚ desconecta   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚connection.update    â”‚
    â”‚ status: 'close'     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚shouldReconnect?     â”‚
    â”‚ (nÃ£o foi logout)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Sim
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  setTimeout(5s)     â”‚
    â”‚ initializeWhatsApp()â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Tenta reconectar    â”‚
    â”‚ automaticamente     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ ComparaÃ§Ã£o de Performance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MÃ‰TRICAS DE PERFORMANCE                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TEMPO DE BUILD (Frontend)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Atual (Create React App):
â”œâ”€â”€ Desenvolvimento (npm start)
â”‚   â””â”€â”€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 30-45 segundos
â”‚
â””â”€â”€ ProduÃ§Ã£o (npm run build)
    â””â”€â”€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2-3 minutos

Novo (Vite):
â”œâ”€â”€ Desenvolvimento (npm run dev)
â”‚   â””â”€â”€ â–ˆ 1-2 segundos  â† 15-30x MAIS RÃPIDO!
â”‚
â””â”€â”€ ProduÃ§Ã£o (npm run build)
    â””â”€â”€ â–ˆâ–ˆâ–ˆ 10-20 segundos  â† 6-9x MAIS RÃPIDO!


USO DE MEMÃ“RIA (Backend)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Atual (whatsapp-web.js + Puppeteer):
â””â”€â”€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 300-500 MB base
    â””â”€â”€ + Picos de 800MB+ quando enviando

Novo (Baileys):
â””â”€â”€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100-150 MB base  â† 60-70% MENOS MEMÃ“RIA!
    â””â”€â”€ + Picos de 200-250MB mÃ¡ximo


TEMPO DE RESPOSTA API
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Atual (Socket.io):
â”œâ”€â”€ LatÃªncia WebSocket: 50-100ms
â””â”€â”€ Sobrecarga manter conexÃµes: Alta

Novo (REST API):
â”œâ”€â”€ LatÃªncia HTTP: 50-200ms
â””â”€â”€ Cache HTTP: Reduz atÃ© 90% requests repetidos!


TAXA DE SUCESSO DE MENSAGENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Atual (whatsapp-web.js):
â””â”€â”€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 85-90%
    â””â”€â”€ Falhas comuns com nÃºmeros novos

Novo (Baileys + Sistema de Fallback):
â””â”€â”€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 95-98%  â† MAIS CONFIÃVEL!
    â””â”€â”€ Sistema inteligente de variaÃ§Ãµes
```

---

## ğŸ” Fluxo de AutenticaÃ§Ã£o e SeguranÃ§a

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AUTENTICAÃ‡ÃƒO E SEGURANÃ‡A                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AUTENTICAÃ‡ÃƒO FRONTEND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ UsuÃ¡rio  â”‚
    â”‚  acessa  â”‚
    â”‚   app    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚localStorage â”‚    Tem login salvo?
    â”‚   check     â”‚â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚              â”‚
                         Sim            NÃ£o
                          â”‚              â”‚
                          â–¼              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Validar  â”‚   â”‚  Tela de â”‚
                    â”‚ timestampâ”‚   â”‚  Login   â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                         â”‚              â”‚
                    < 24hâ”‚  > 24h       â”‚ Login
                         â”‚    â”‚         â”‚ correto
                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
                    â”‚   App Autenticado      â”‚
                    â”‚                        â”‚
                    â”‚ Login: chatbot         â”‚
                    â”‚ Senha: criadores       â”‚
                    â”‚                        â”‚
                    â”‚ Salvo no localStorage  â”‚
                    â”‚ VÃ¡lido por 24h         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


SEGURANÃ‡A API (Backend)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    ProduÃ§Ã£o:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ HTTPS (Let's Encrypt)           â”‚
    â”‚ â”œâ”€â”€ Certificado SSL automÃ¡tico  â”‚
    â”‚ â””â”€â”€ RenovaÃ§Ã£o automÃ¡tica        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Nginx Reverse Proxy             â”‚
    â”‚ â”œâ”€â”€ Rate limiting               â”‚
    â”‚ â”œâ”€â”€ Compression (gzip)          â”‚
    â”‚ â””â”€â”€ Static files cache          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Express Backend                 â”‚
    â”‚ â”œâ”€â”€ CORS configurado            â”‚
    â”‚ â”‚   â””â”€â”€ Only: chatbot.domain    â”‚
    â”‚ â”œâ”€â”€ Body size limit: 10MB       â”‚
    â”‚ â”œâ”€â”€ Trust proxy: true           â”‚
    â”‚ â””â”€â”€ JSON parser                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Desenvolvimento:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ HTTP Simples                    â”‚
    â”‚ â”œâ”€â”€ CORS: * (all origins)      â”‚
    â”‚ â”œâ”€â”€ No SSL                      â”‚
    â”‚ â””â”€â”€ Vite proxy                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ Modelo de Dados - Relacionamentos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MODELO DE DADOS MONGODB                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COLLECTIONS:
â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  tb_envio_validacoes                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id: ObjectId                       â”‚
â”‚ telefone: String â—„â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ nome_completo: String   â”‚           â”‚
â”‚ status_mensagem: String â”‚           â”‚
â”‚ id_mensagem: String â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ dataEnvio: Date         â”‚       â”‚   â”‚
â”‚ reenvioTentado: Boolean â”‚       â”‚   â”‚
â”‚ historicoReenvios: []   â”‚       â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜
                          â”‚       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”
â”‚  tb_envio_senhas        â”‚       â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ _id: ObjectId           â”‚       â”‚   â”‚
â”‚ telefone: String â—„â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚ nome_completo: String           â”‚   â”‚
â”‚ senha_provisoria: String        â”‚   â”‚
â”‚ status_mensagem: String         â”‚   â”‚
â”‚ id_mensagem: String â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ dataEnvio: Date                 â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜
                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”
â”‚  tb_envio_mensagens             â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ _id: ObjectId                   â”‚   â”‚
â”‚ id_lote: String                 â”‚   â”‚
â”‚ mensagem: String                â”‚   â”‚
â”‚ criadores: [                    â”‚   â”‚
â”‚   {                             â”‚   â”‚
â”‚     codigo: Number              â”‚   â”‚
â”‚     nome_completo: String       â”‚   â”‚
â”‚     telefone: String            â”‚   â”‚
â”‚     status_mensagem: String     â”‚   â”‚
â”‚     id_mensagem: String â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   }                                 â”‚
â”‚ ]                                   â”‚
â”‚ totalEnviados: Number               â”‚
â”‚ sucessos: Number                    â”‚
â”‚ erros: Number                       â”‚
â”‚ dataEnvio: Date                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ÃNDICES CRIADOS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

tb_envio_validacoes:
â”œâ”€â”€ telefone (para busca rÃ¡pida)
â””â”€â”€ dataEnvio (para ordenaÃ§Ã£o)

tb_envio_senhas:
â”œâ”€â”€ telefone
â””â”€â”€ dataEnvio

tb_envio_mensagens:
â”œâ”€â”€ id_lote (para buscar lote especÃ­fico)
â””â”€â”€ dataEnvio


QUERIES COMUNS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Buscar todas validaÃ§Ãµes de um nÃºmero:
   db.tb_envio_validacoes.find({ telefone: "11999999999" })

2. Buscar mensagens nÃ£o entregues:
   db.tb_envio_validacoes.find({ 
     status_mensagem: "Enviada",
     dataEnvio: { $lt: new Date(Date.now() - 5*60*1000) }
   })

3. EstatÃ­sticas de envio:
   db.tb_envio_validacoes.aggregate([
     { $group: {
       _id: "$status_mensagem",
       count: { $sum: 1 }
     }}
   ])
```

---

**Criado em:** 21 de Outubro de 2025  
**VersÃ£o:** 1.0  
**PrÃ³ximo:** Veja [README_MIGRACAO.md](./README_MIGRACAO.md) para Ã­ndice completo

